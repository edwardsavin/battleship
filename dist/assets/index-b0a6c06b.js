(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(o){if(o.ep)return;o.ep=!0;const e=r(o);fetch(o.href,e)}})();function N(){const t=document.createElement("footer");t.classList.add("footer");const n=document.createElement("div");n.classList.add("footer-wrapper");const r=document.createElement("p");r.innerHTML=`Copyright 춸 ${new Date().getFullYear()}`;const a=document.createElement("a");return a.classList.add("footer-link"),a.href="https://edwardcs.com",a.target="_blank",a.textContent="Edward Savin",n.appendChild(r),n.appendChild(a),t.appendChild(n),t}function O(t,n,r){for(let a=0;a<t;a+=1)for(let o=0;o<n;o+=1){const e=document.createElement("div");e.classList.add("board__cell"),e.setAttribute("data-x",`${a}`),e.setAttribute("data-y",`${o}`),r.appendChild(e)}}function S(t,n){const r=document.createElement("div");return r.classList.add(`board-${t}`),O(10,10,r),n&&n.forEach(a=>{a.coordinates.forEach(o=>{const e=r.querySelector(`[data-x="${o[0]}"][data-y="${o[1]}"]`);e&&!a.isComputer&&(e.classList.add("ship"),e.setAttribute("data-ship",`${a.name}`))})}),r}function $(){return document.querySelector(".main__content-wrapper")}function k(t){const n=document.createElement("div");n.classList.add("player__title-container");const r=document.createElement("h2");return r.classList.add("player__title"),r.textContent=`${t}'s Board`,n.appendChild(r),n}function G(t,n,r){const a=document.querySelector(".main__container");a.style.justifyContent="center";const o=document.querySelector(".main__container-title");o.style.marginBottom="0";const e=document.querySelector(".content-wrapper__game-container");e==null||e.remove();const i=document.createElement("div");i.classList.add("game-over-container");const c=document.createElement("h1");c.classList.add("game-over"),c.textContent=`${t.name} wins!`,i.appendChild(c);const s=document.createElement("button");s.classList.add("play-again"),s.textContent="Play Again",i.appendChild(s),r==null||r.appendChild(i),s.addEventListener("click",()=>{c.remove(),s.remove(),"isComputer"in t?y(n.name):y(t.name)})}function M(t,n,r,a){const o=document.querySelector(`.board-${a.name} [data-x="${t}"][data-y="${n}"]`);if(o&&(a.gameboard.board[t][n]==="miss"?o.classList.add("miss"):a.gameboard.board[t][n]==="hit"&&o.classList.add("hit")),a.gameboard.checkIfAllShipsSunk()){G(r,a,$());return}if("isComputer"in a){const e=a.smartAttack(r),[i,c]=e;M(i,c,a,r)}}function T(t){const n=t.player.name,r=t.computer.name,a=$(),o=document.createElement("div");o.classList.add("content-wrapper__game-container");const e=document.createElement("div");e.classList.add(`player-wrapper-${n}`);const i=k(n),c=S(n,t.playerShips);c.classList.remove("board-temp"),e.appendChild(i),e.appendChild(c);const s=document.createElement("div");s.classList.add(`player-wrapper-${r}`);const d=k(r),l=S(r,t.computerShips);return s.appendChild(d),s.appendChild(l),o.appendChild(e),o.appendChild(s),a==null||a.appendChild(o),l.querySelectorAll(".board__cell").forEach(g=>{g.addEventListener("click",p=>{const f=Number(p.target.dataset.x),u=Number(p.target.dataset.y);t.player.attack(f,u,t.computer),M(f,u,t.player,t.computer)})}),o}function V(){const t=Array.from({length:10},()=>Array.from({length:10},()=>null));function n(s,d){return t[s][d]!==null}function r(s,d){t[s][d]="hit"}function a(s,d){t[s][d]="miss"}function o(s,d){return t[s][d]==="hit"}function e(s,d,l,g){if(n(d,l))throw new Error("Ship already placed at coordinates");if(g)for(let p=0;p<s.length;p+=1)t[d][l+p]=s,s.changeCoordinates(d,l+p);else if(!g)for(let p=0;p<s.length;p+=1)t[d+p][l]=s,s.changeCoordinates(d+p,l)}function i(s,d){if(o(s,d))return;if(!n(s,d)){a(s,d);return}const l=t[s][d];l&&typeof l!="string"&&(l.hit(),r(s,d))}function c(){return t.every(s=>s.every(d=>d&&typeof d!="string"?d.isSunk():!0))}return{board:t,placeShip:e,receiveAttack:i,checkIfAllShipsSunk:c,isShipPlaced:n}}function b(t,n){let r=0;const a=[];function o(){return r===t}function e(){if(o())throw new Error("Ship is sunk");r+=1}function i(){return r}function c(s,d){a.push([s,d])}return{length:t,name:n,isSunk:o,hit:e,getHits:i,changeCoordinates:c,coordinates:a}}function B(t){const n=V(),r=[b(5,"Carrier"),b(4,"Battleship"),b(3,"Destroyer"),b(3,"Submarine"),b(2,"Patrol Boat")];function a(e,i,c,s){n.placeShip(e,i,c,s)}function o(e,i,c){if(c.gameboard.board[e][i]==="miss"||c.gameboard.board[e][i]==="hit")throw new Error("You have already attacked this coordinate");c.gameboard.receiveAttack(e,i)}return{name:t,gameboard:n,ships:r,placeShip:a,attack:o}}function j(t,n,r,a,o){const e=[];if(a+n<=o){let i=!0;for(let c=0;c<n;c+=1)if(t.gameboard.board[r][a+c]!==null){i=!1;break}i&&e.push([r,a,!0])}return e}function H(t,n,r,a,o){const e=[];if(r+n<=o){let i=!0;for(let c=0;c<n;c+=1)if(t.gameboard.board[r+c][a]!==null){i=!1;break}i&&e.push([r,a,!1])}return e}function D(t,n,r){const a=[];for(let o=0;o<r;o+=1)for(let e=0;e<r;e+=1)a.push(...j(t,n,o,e,r),...H(t,n,o,e,r));return a}function A(t,n){const r=[];return t-1>=0&&r.push([t-1,n]),t+1<10&&r.push([t+1,n]),n-1>=0&&r.push([t,n-1]),n+1<10&&r.push([t,n+1]),r}function I(){const t=B("Computer");function n(){t.ships.forEach(e=>{const i=D(t,e.length,10),[c,s,d]=i[Math.floor(Math.random()*i.length)];t.placeShip(e,c,s,d)})}function r(e){let i=Math.floor(Math.random()*10),c=Math.floor(Math.random()*10);for(;e.gameboard.board[i][c]==="miss"||e.gameboard.board[i][c]==="hit";)i=Math.floor(Math.random()*10),c=Math.floor(Math.random()*10);return t.attack(i,c,e),[i,c]}let a=[];function o(e){if(a.length===0){const[d,l]=r(e);return e.gameboard.board[d][l]==="hit"&&(a=A(d,l)),[d,l]}let i=a.pop();for(;i&&(e.gameboard.board[i[0]][i[1]]==="miss"||e.gameboard.board[i[0]][i[1]]==="hit");){if(a.length===0)return o(e);i=a.pop()}if(!i)return o(e);const[c,s]=i;return t.attack(c,s,e),e.gameboard.board[c][s]==="hit"&&a.push(...A(c,s)),[c,s]}return{...t,placeShips:n,smartAttack:o,isComputer:!0}}function P(t,n=!1){const{ships:r}=t;return r.map(o=>({isComputer:n,name:o.name,coordinates:o.coordinates}))}function F(t){const n=B(t),r=I();r.placeShips();const a=P(n),o=P(r,!0);return{player:n,computer:r,playerShips:a,computerShips:o}}function Y(){const t=document.querySelector(".content-wrapper__new-game-container");t==null||t.remove()}function x(t,n,r,a){return a?n+r>10:t+r>10}function q(t){return t.classList.contains("ship")}function K(t){return t.dataset.validPlacement==="true"}function L(t,n,r,a,o){return a?o.querySelector(`[data-x="${t}"][data-y="${n+r}"]`):o.querySelector(`[data-x="${t+r}"][data-y="${n}"]`)}function W(t,n,r,a,o){for(let e=0;e<o.length;e+=1){const i=L(t,n,e,r,a);i&&(i.dataset.hoverShip=o.name)}}function X(t,n,r,a,o,e){e.addEventListener("mouseleave",()=>{for(let i=0;i<o.length;i+=1){const c=L(t,n,i,r,a);c&&delete c.dataset.hoverShip}})}function J(t,n,r,a,o,e){const i=a;if(x(o,e,n.length,r)){i.dataset.validPlacement="false";return}for(let c=0;c<n.length;c+=1){const s=L(o,e,c,r,t);if(s&&q(s)){i.dataset.validPlacement="false";return}}W(o,e,r,t,n),X(o,e,r,t,n,i),i.dataset.validPlacement="true"}function y(t){Y();const n=document.querySelector(".main__container");n.style.justifyContent="flex-start";const r=document.querySelector(".main__content-wrapper"),a=document.createElement("div");a.classList.add("content-wrapper__temp-board-container");const o=document.createElement("h2");o.classList.add("temp-board__title");let e=!0;const i=document.createElement("button");i.classList.add("temp-board__rotate-button"),i.textContent="Vertical 游대",e?i.textContent="Horizontal 游대":i.textContent="Vertical 游대";const c=S(t);c.classList.add("board-temp"),a.appendChild(o),a.appendChild(i),a.appendChild(c),r==null||r.appendChild(a);const s=F(t);let d=s.player.ships[0];o.textContent=`Place your ${d.name}`,i.addEventListener("click",()=>{e=!e,e?i.textContent="Horizontal 游대":i.textContent="Vertical 游대"});function l(f){const u=f.target,C=Number(u.dataset.x),v=Number(u.dataset.y);J(c,d,e,u,C,v)}function g(f){const u=f.target;delete u.dataset.validPlacement}function p(f){const u=f.target,C=Number(u.dataset.x),v=Number(u.dataset.y),m=document.createElement("p");m.classList.add("temp-board__error"),m.setAttribute("role","alert");const _=document.querySelector(".temp-board__error");if(_&&_.remove(),x(C,v,d.length,e)){m.textContent="Ship is out of bounds.",a.insertBefore(m,c),delete u.dataset.validPlacement;return}if(q(u)){m.textContent="This cell is already occupied by a ship.",a.insertBefore(m,c),delete u.dataset.validPlacement;return}if(!K(u)){m.textContent="Cannot place ship on top of another ship.",a.insertBefore(m,c),delete u.dataset.validPlacement;return}try{s.player.placeShip(d,C,v,e)}catch(h){h instanceof Error&&(m.textContent=h.message);return}u.classList.add("ship"),u.dataset.ship=d.name,u.dataset.shipPart="0";for(let h=1;h<d.length;h+=1){const E=c.querySelector(`[data-x="${e?C:C+h}"][data-y="${e?v+h:v}"]`);E.classList.add("ship"),E.dataset.ship=d.name,E.dataset.shipPart=`${h}`}const w=s.player.ships.indexOf(d)+1;w<s.player.ships.length?(d=s.player.ships[w],o.textContent=`Place your ${d.name}`):(a.remove(),c.removeEventListener("mouseover",l),c.removeEventListener("touchstart",l),c.removeEventListener("mouseout",g),c.removeEventListener("click",p),T(s))}return c.addEventListener("mouseover",l),c.addEventListener("touchstart",l),c.addEventListener("mouseout",g),c.addEventListener("click",p),a}function Q(){const t=document.createElement("div");t.classList.add("content-wrapper__new-game-container");const n=document.createElement("input");n.classList.add("new-game__input-player-name"),n.setAttribute("type","text"),n.setAttribute("placeholder","Enter your name"),n.setAttribute("maxlength","12");const r=document.createElement("button");r.classList.add("new-game__button-start-game"),r.textContent="Start";function a(){if(n.value===""){const e=document.createElement("p");e.classList.add("new-game__error"),e.setAttribute("role","alert"),e.textContent="The name is required.",t.insertBefore(e,n);return}const o=n.value;y(o)}return n.addEventListener("keyup",o=>{o.key==="Enter"&&a()}),r.addEventListener("click",a),t.appendChild(n),t.appendChild(r),t}function R(){const t=document.querySelector("#main"),n=document.createElement("div");n.classList.add("main__container"),n.style.justifyContent="center";const r=document.createElement("div");r.classList.add("main__content-wrapper");const a=document.createElement("h1");a.classList.add("main__container-title"),a.textContent="Battleship 44";const o=Q();r.appendChild(o);const e=N();n.appendChild(a),n.appendChild(r),t==null||t.appendChild(n),t==null||t.appendChild(e)}R();
